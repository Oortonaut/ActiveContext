<?plantuml 1.2026.1beta5?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="955px" preserveAspectRatio="none" style="width:786px;height:955px;background:#FFFFFF;" version="1.1" viewBox="0 0 786 955" width="786px" zoomAndPan="magnify"><title>ACP Protocol - Terminal Operations</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="438.7646" x="172.2285" y="35.4209">ACP Protocol - Terminal Operations</text><g><title>Shell</title><rect fill="#FFFFFF" height="381.8594" style="stroke:#000000;stroke-width:1;" width="10" x="661.5098" y="283.1016"/></g><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="A" id="part1-lifeline"><g><title>Agent</title><rect fill="#000000" fill-opacity="0.00000" height="837.1172" width="8" x="352.7197" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="356" x2="356" y1="82.9063" y2="920.0234"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="C" id="part2-lifeline"><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="837.1172" width="8" x="542.2729" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="546.0078" x2="546.0078" y1="82.9063" y2="920.0234"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="S" id="part3-lifeline"><g><title>Shell</title><rect fill="#000000" fill-opacity="0.00000" height="837.1172" width="8" x="662.5098" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="666.4336" x2="666.4336" y1="82.9063" y2="920.0234"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="A" id="part1-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="55.4395" x="329" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="336" y="71.6045">Agent</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="A" id="part1-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="55.4395" x="329" y="919.0234"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="336" y="939.0186">Agent</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="C" id="part2-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="519.0078" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="526.0078" y="71.6045">Client</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="C" id="part2-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="519.0078" y="919.0234"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="526.0078" y="939.0186">Client</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="S" id="part3-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="48.1523" x="642.4336" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="34.1523" x="649.4336" y="71.6045">Shell</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="S" id="part3-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="48.1523" x="642.4336" y="919.0234"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="34.1523" x="649.4336" y="939.0186">Shell</text></g><g><title>Shell</title><rect fill="#FFFFFF" height="381.8594" style="stroke:#000000;stroke-width:1;" width="10" x="661.5098" y="283.1016"/></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="774.2217" x="5" y="113.4727"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="113.4727" y2="113.4727"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="116.4727" y2="116.4727"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="136.2051" x="324.0083" y="102.9063"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117.6792" x="330.0083" y="118.9731">Create Terminal</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg1"><polygon fill="#000000" points="534.2729,201.5703,544.2729,205.5703,534.2729,209.5703,538.2729,205.5703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="356.7197" x2="540.2729" y1="205.5703" y2="205.5703"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="100.4644" x="363.7197" y="200.5044">terminal/create</text></g><path d="M551,141.0391 L551,256.0391 L766,256.0391 L766,151.0391 L756,141.0391 L551,141.0391" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M756,141.0391 L756,151.0391 L766,151.0391 L756,141.0391" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="557" y="158.106">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179.7656" x="565.2646" y="173.2388">"sessionId": "sess_abc123",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.3589" x="565.2646" y="188.3716">"command": "pytest",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.7681" x="565.2646" y="203.5044">"args": ["-v", "tests/"],</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="186.3481" x="565.2646" y="218.6372">"cwd": "/home/user/project",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="183.1807" x="565.2646" y="233.77">"outputByteLimit": 1048576</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="557" y="248.9028">}</text><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg3"><polygon fill="#000000" points="649.5098,279.1016,659.5098,283.1016,649.5098,287.1016,653.5098,283.1016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="546.2729" x2="655.5098" y1="283.1016" y2="283.1016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="96.2368" x="553.2729" y="278.0356">spawn process</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg4"><polygon fill="#000000" points="367.7197,326.3672,357.7197,330.3672,367.7197,334.3672,363.7197,330.3672" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="361.7197" x2="545.2729" y1="330.3672" y2="330.3672"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="163.8774" x="373.7197" y="325.3013">CreateTerminalResponse</text></g><path d="M160,296.1016 L160,351.1016 L350,351.1016 L350,306.1016 L340,296.1016 L160,296.1016" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M340,296.1016 L340,306.1016 L350,306.1016 L340,296.1016" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="166" y="313.1685">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="161.4653" x="174.2646" y="328.3013">"terminalId": "term_001"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="166" y="343.4341">}</text><path d="M321,361.5 L321,401.5 L580,401.5 L580,371.5 L570,361.5 L321,361.5" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M570,361.5 L570,371.5 L580,371.5 L570,361.5" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="236.9326" x="327.8027" y="378.5669">terminal/create returns immediately</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="205.5435" x="327.8027" y="393.6997">Command runs asynchronously</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="774.2217" x="5" y="427.332"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="427.332" y2="427.332"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="430.332" y2="430.332"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="101.7183" x="341.2517" y="416.7656"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="83.1924" x="347.2517" y="432.8325">Poll Output</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg6"><polygon fill="#000000" points="534.2729,470.0313,544.2729,474.0313,534.2729,478.0313,538.2729,474.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="356.7197" x2="540.2729" y1="474.0313" y2="474.0313"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="101.791" x="363.7197" y="468.9653">terminal/output</text></g><path d="M551,454.8984 L551,479.8984 L750,479.8984 L750,464.8984 L740,454.8984 L551,454.8984" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M740,454.8984 L740,464.8984 L750,464.8984 L740,454.8984" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.0073" x="557" y="471.9653">{"terminalId": "term_001"}</text><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg8"><polygon fill="#000000" points="367.7197,527.8633,357.7197,531.8633,367.7197,535.8633,363.7197,531.8633" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="361.7197" x2="545.2729" y1="531.8633" y2="531.8633"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="165.5532" x="373.7197" y="526.7974">TerminalOutputResponse</text></g><path d="M10,490.0313 L10,560.0313 L352,560.0313 L352,500.0313 L342,490.0313 L10,490.0313" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M342,490.0313 L342,500.0313 L352,500.0313 L342,490.0313" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="16" y="507.0981">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="313.0283" x="24.2646" y="522.231">"output": "test_auth.py::test_login PASSED\n...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.7783" x="24.2646" y="537.3638">"truncated": false</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="16" y="552.4966">}</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="774.2217" x="5" y="586.1289"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="586.1289" y2="586.1289"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="589.1289" y2="589.1289"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="110.2939" x="336.9639" y="575.5625"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91.7681" x="342.9639" y="591.6294">Wait for Exit</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg10"><polygon fill="#000000" points="534.2729,628.8281,544.2729,632.8281,534.2729,636.8281,538.2729,632.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="356.7197" x2="540.2729" y1="632.8281" y2="632.8281"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.4956" x="363.7197" y="627.7622">terminal/wait_for_exit</text></g><path d="M551,613.6953 L551,638.6953 L750,638.6953 L750,623.6953 L740,613.6953 L551,613.6953" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M740,613.6953 L740,623.6953 L750,623.6953 L740,613.6953" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.0073" x="557" y="630.7622">{"terminalId": "term_001"}</text><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg12"><polygon fill="#000000" points="557.2729,660.9609,547.2729,664.9609,557.2729,668.9609,553.2729,664.9609" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="551.2729" x2="665.5098" y1="664.9609" y2="664.9609"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.1348" x="563.2729" y="659.895">Process exits</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg13"><polygon fill="#000000" points="367.7197,715.793,357.7197,719.793,367.7197,723.793,363.7197,719.793" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="361.7197" x2="545.2729" y1="719.793" y2="719.793"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="137.9409" x="373.7197" y="714.7271">WaitForExitResponse</text></g><path d="M231,677.9609 L231,747.9609 L350,747.9609 L350,687.9609 L340,677.9609 L231,677.9609" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M340,677.9609 L340,687.9609 L350,687.9609 L340,677.9609" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="237" y="695.0278">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.5557" x="245.2646" y="710.1606">"exitCode": 0,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.6274" x="245.2646" y="725.2935">"signal": null</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="237" y="740.4263">}</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="774.2217" x="5" y="774.0586"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="774.0586" y2="774.0586"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="777.0586" y2="777.0586"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="63.9561" x="360.1328" y="763.4922"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="45.4302" x="366.1328" y="779.5591">Or Kill</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg15"><polygon fill="#000000" points="534.2729,816.7578,544.2729,820.7578,534.2729,824.7578,538.2729,820.7578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="356.7197" x2="540.2729" y1="820.7578" y2="820.7578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.2764" x="363.7197" y="815.6919">terminal/kill</text></g><path d="M551,801.625 L551,826.625 L768,826.625 L768,811.625 L758,801.625 L551,801.625" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M758,801.625 L758,811.625 L768,811.625 L758,801.625" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="196.9487" x="557" y="818.6919">Terminates running command</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="774.2217" x="5" y="852.3242"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="852.3242" y2="852.3242"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="779.2217" y1="855.3242" y2="855.3242"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="75.9531" x="354.1343" y="841.7578"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.4272" x="360.1343" y="857.8247">Release</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg17"><polygon fill="#000000" points="534.2729,895.0234,544.2729,899.0234,534.2729,903.0234,538.2729,899.0234" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="356.7197" x2="540.2729" y1="899.0234" y2="899.0234"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="106.6025" x="363.7197" y="893.9575">terminal/release</text></g><path d="M551,879.8906 L551,904.8906 L687,904.8906 L687,889.8906 L677,879.8906 L551,879.8906" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M677,879.8906 L677,889.8906 L687,889.8906 L677,879.8906" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="115.8447" x="557" y="896.9575">Free all resources</text><?plantuml-src ZLDTYzim47pNhzZwEP_zF08fkEuTb1Okd0jzk9QWEXjRhImPQPqq7FdlNLaETpvgwACqixCxiz8Bgh16QBHKHWXIf17IR0CRPyaMLiCKlgAhbP4QRXjqafGrNeX6EbA5QgGXID8I3IKWFQH38DFgWcH39AzGwmx8XLYl8NCe2HzxhTT2f31z3nciWFhRUT6nXB5CTQgiI3m8WCIZzppMfrsoYeUj_5aiNxvA9W4jR5rBqs7DYT1Jl9Qkz7ntdqmFoGII0FXvyYEM73lwlB8rpbkFRjuu-mkBljIsrBJqWSM-g5eHKvUBrrTlthqLPu5c1s4-8R8mVixZ-qOU3R12mQC9MP0w1AzvHs5Eofpe_sB_3dt3CVTEDUvxevSWejDmsYuMosJGjYkn1tIGJZXrU9uUEAJM6G-ghd6d-4QVc9N5bC2r34b_CaNbhB6jP_HHd3UriPgVGfV0o9PYF4-sj8A7iT7FJqEus8_gOo54-QZYQIjRgcRDQRNgJjgMoi0cpVFhZz_DR3QB6oEsLR3Lq7mlDOkUXww-IKMmjmwk_wWnNqVcR9cpHURyjxsyinU4Dl45G2ZtOeV_VWbXaXlhmXnZ2GI1pEwGMoqwUrwLt9kFfjNwkRLR1v-L7ljIlnaQUEcNm6c6js2KAQ7_GPtQ7MgK7aVKN4G7WZSE4IGFuD3Rrd44Vm40?></g></svg>