<?plantuml 1.2026.1beta5?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="590px" preserveAspectRatio="none" style="width:866px;height:590px;background:#FFFFFF;" version="1.1" viewBox="0 0 866 590" width="866px" zoomAndPan="magnify"><title>ACP Protocol - Permission Request Flow</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="496.8154" x="188.6516" y="35.4209">ACP Protocol - Permission Request Flow</text><rect fill="#FFFFFF" height="82.5313" style="stroke:#000000;stroke-width:1;" width="447.9092" x="14" y="455.4297"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="C" id="part1-lifeline"><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="472.0547" width="8" x="206.2651" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="210" x2="210" y1="82.9063" y2="554.9609"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="A" id="part2-lifeline"><g><title>Agent</title><rect fill="#000000" fill-opacity="0.00000" height="472.0547" width="8" x="410.1895" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="413.4697" x2="413.4697" y1="82.9063" y2="554.9609"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="U" id="part3-lifeline"><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="472.0547" width="8" x="490.8643" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="493.9092" x2="493.9092" y1="82.9063" y2="554.9609"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="C" id="part1-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="183" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="190" y="71.6045">Client</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="C" id="part1-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="183" y="553.9609"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="190" y="573.9561">Client</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="A" id="part2-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="55.4395" x="386.4697" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="393.4697" y="71.6045">Agent</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="A" id="part2-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="55.4395" x="386.4697" y="553.9609"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="41.4395" x="393.4697" y="573.9561">Agent</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="U" id="part3-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="45.9102" x="471.9092" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="478.9092" y="71.6045">User</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="U" id="part3-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="45.9102" x="471.9092" y="553.9609"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="478.9092" y="573.9561">User</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg1"><polygon fill="#000000" points="221.2651,211.4023,211.2651,215.4023,221.2651,219.4023,217.2651,215.4023" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="215.2651" x2="413.1895" y1="215.4023" y2="215.4023"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179.9243" x="227.2651" y="210.3364">session/request_permission</text></g><path d="M419,97.9063 L419,318.9063 L859,318.9063 L859,107.9063 L849,97.9063 L419,97.9063" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M849,97.9063 L849,107.9063 L859,107.9063 L849,97.9063" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="425" y="114.9731">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179.7656" x="433.2646" y="130.106">"sessionId": "sess_abc123",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.6255" x="433.2646" y="145.2388">"toolCall": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="141.0894" x="441.5293" y="160.3716">"toolCallId": "tc_001",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="188.6904" x="441.5293" y="175.5044">"title": "Write to config.json",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="85.0205" x="441.5293" y="190.6372">"kind": "edit"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="433.2646" y="205.77">},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="73.4233" x="433.2646" y="220.9028">"options": [</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="376.7905" x="441.5293" y="236.0356">{"id": "opt1", "kind": "allow_once", "label": "Allow once"},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="403.3999" x="441.5293" y="251.1685">{"id": "opt2", "kind": "allow_always", "label": "Always allow"},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="343.9795" x="441.5293" y="266.3013">{"id": "opt3", "kind": "reject_once", "label": "Deny"},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="395.8779" x="441.5293" y="281.4341">{"id": "opt4", "kind": "reject_always", "label": "Never allow"}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="433.2646" y="296.5669">]</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="425" y="311.6997">}</text><g class="message" data-entity-1="part1" data-entity-2="part3" id="msg3"><polygon fill="#000000" points="482.8643,341.8984,492.8643,345.8984,482.8643,349.8984,486.8643,345.8984" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="210.2651" x2="488.8643" y1="345.8984" y2="345.8984"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.21" x="217.2651" y="340.8325">Show permission dialog</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg4"><polygon fill="#000000" points="221.2651,371.0313,211.2651,375.0313,221.2651,379.0313,217.2651,375.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="215.2651" x2="493.8643" y1="375.0313" y2="375.0313"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="155.8477" x="227.2651" y="369.9653">User clicks "Allow once"</text></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg5"><polygon fill="#000000" points="402.1895,418.2969,412.1895,422.2969,402.1895,426.2969,406.1895,422.2969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="210.2651" x2="408.1895" y1="422.2969" y2="422.2969"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="133.8276" x="217.2651" y="417.231">PermissionResponse</text></g><path d="M60,388.0313 L60,443.0313 L204,443.0313 L204,398.0313 L194,388.0313 L60,388.0313" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M194,388.0313 L194,398.0313 L204,398.0313 L194,388.0313" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="66" y="405.0981">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="115.1973" x="74.2646" y="420.231">"optionId": "opt1"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="66" y="435.3638">}</text><path d="M14,455.4297 L78.4429,455.4297 L78.4429,462.5625 L68.4429,472.5625 L14,472.5625 L14,455.4297" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="82.5313" style="stroke:#000000;stroke-width:1;" width="447.9092" x="14" y="455.4297"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="29" y="468.4966">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="254.1118" x="93.4429" y="467.6401">[User cancels prompt during permission]</text><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg7"><polygon fill="#000000" points="402.1895,507.8281,412.1895,511.8281,402.1895,515.8281,406.1895,511.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="210.2651" x2="408.1895" y1="511.8281" y2="511.8281"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="133.8276" x="217.2651" y="506.7622">PermissionResponse</text></g><path d="M24,477.5625 L24,532.5625 L204,532.5625 L204,487.5625 L194,477.5625 L24,477.5625" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M194,477.5625 L194,487.5625 L204,487.5625 L194,477.5625" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="30" y="494.6294">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="151.4551" x="38.2646" y="509.7622">"outcome": "cancelled"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="30" y="524.895">}</text><?plantuml-src VLBBJiCm4BpxAvQSAUyJ1wGe2AaNL84g3WXLnbbIKzSRx2qLGlrtravBsb9ng9JEpCvCidl4KvmZj4vRhnHRTWXbDO9H82P33WOmmZ2tCLhoy80V2umCTuwMIhKwi3MsrPwXg9n5pmNe2DKkKpORejmbnX53niTAbJ2uWGgk8MAEEWrTrAJzJLUU627OPihgMm4KQ-cmBgwxFnFzQiulBelZn3AHgxHpGYRr5j8Di9cSdPrdRUBIcoVuALX9OG93_iqs9--H_4OqipwFOcsv46YLWwXbQH65UCwoxy9cbU1Ytqz9CYqdv0qcrEbNJDsACi6GuTNnli75NmFjblehxbaa239_mEHosoJWEnh-M-CM_TU1sQi3imSQtECdXaq1yNXHAuM-XhGofQgqtB4izt4ghzfl56gh7JLg38FrzjD9W77MpEBEbyaUeYb5qz_Z0yPMlZnsb-7mRNqOtKQ6_HPsscZ7wnmjrYv26sZUCjIBO7spLK-i_aq5w7DXSsIqO4FpV4gTlyCwtuhyVZl8mmy0?></g></svg>