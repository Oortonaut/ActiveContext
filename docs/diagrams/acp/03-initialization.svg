<?plantuml 1.2026.1beta5?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="966px" preserveAspectRatio="none" style="width:631px;height:966px;background:#FFFFFF;" version="1.1" viewBox="0 0 631 966" width="631px" zoomAndPan="magnify"><title>ACP Protocol - Initialization Handshake</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="486.1592" x="74.1094" y="35.4209">ACP Protocol - Initialization Handshake</text><g><title>Agent Process</title><rect fill="#FFFFFF" height="800.375" style="stroke:#000000;stroke-width:1;" width="10" x="406.4512" y="122.0391"/></g><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="C" id="part1-lifeline"><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="848.5078" width="8" x="232.2651" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="236" x2="236" y1="82.9063" y2="931.4141"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="A" id="part2-lifeline"><g><title>Agent Process</title><rect fill="#000000" fill-opacity="0.00000" height="848.5078" width="8" x="407.4512" y="82.9063"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:5,5;" x1="410.6753" x2="410.6753" y1="82.9063" y2="931.4141"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="C" id="part1-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="209" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="216" y="71.6045">Client</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="C" id="part1-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="54.5303" x="209" y="930.4141"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="216" y="950.4092">Client</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="A" id="part2-head"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="113.5518" x="354.6753" y="51.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="99.5518" x="361.6753" y="71.6045">Agent Process</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="A" id="part2-tail"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="113.5518" x="354.6753" y="930.4141"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="99.5518" x="361.6753" y="950.4092">Agent Process</text></g><g><title>Agent Process</title><rect fill="#FFFFFF" height="800.375" style="stroke:#000000;stroke-width:1;" width="10" x="406.4512" y="122.0391"/></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg1"><line style="stroke:#000000;stroke-width:1;" x1="236.2651" x2="278.2651" y1="114.0391" y2="114.0391"/><line style="stroke:#000000;stroke-width:1;" x1="278.2651" x2="278.2651" y1="114.0391" y2="127.0391"/><line style="stroke:#000000;stroke-width:1;" x1="237.2651" x2="278.2651" y1="127.0391" y2="127.0391"/><polygon fill="#000000" points="247.2651,123.0391,237.2651,127.0391,247.2651,131.0391,243.2651,127.0391" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="161.186" x="243.2651" y="108.9731">spawn agent subprocess</text></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg2"><polygon fill="#000000" points="394.4512,298.9336,404.4512,302.9336,394.4512,306.9336,398.4512,302.9336" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="236.2651" x2="400.4512" y1="302.9336" y2="302.9336"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="54.1836" x="243.2651" y="297.8677">initialize</text></g><path d="M421,140.0391 L421,452.0391 L624,452.0391 L624,150.0391 L614,140.0391 L421,140.0391" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M614,140.0391 L614,150.0391 L624,150.0391 L614,140.0391" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="427" y="157.106">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="104.5586" x="435.2646" y="172.2388">"jsonrpc": "2.0",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="44.7383" x="435.2646" y="187.3716">"id": 0,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="140.9497" x="435.2646" y="202.5044">"method": "initialize",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="77.708" x="435.2646" y="217.6372">"params": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="135.002" x="443.5293" y="232.77">"protocolVersion": 1,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="140.2769" x="443.5293" y="247.9028">"clientCapabilities": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="40.0918" x="451.7939" y="263.0356">"fs": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.2725" x="460.0586" y="278.1685">"readTextFile": true,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131.2632" x="460.0586" y="293.3013">"writeTextFile": true</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="451.7939" y="308.4341">},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="101.6831" x="451.7939" y="323.5669">"terminal": true</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="443.5293" y="338.6997">},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.0513" x="443.5293" y="353.8325">"clientInfo": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="103.981" x="451.7939" y="368.9653">"name": "rider",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="158.1328" x="451.7939" y="384.0981">"title": "JetBrains Rider",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="125.5313" x="451.7939" y="399.231">"version": "2025.3"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="443.5293" y="414.3638">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="435.2646" y="429.4966">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="427" y="444.6294">}</text><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg4"><polygon fill="#000000" points="247.2651,659.4219,237.2651,663.4219,247.2651,667.4219,243.2651,663.4219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="241.2651" x2="405.4512" y1="663.4219" y2="663.4219"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="117.4253" x="253.2651" y="658.356">InitializeResponse</text></g><path d="M10,462.6953 L10,850.6953 L232,850.6953 L232,472.6953 L222,462.6953 L10,462.6953" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M222,462.6953 L222,472.6953 L232,472.6953 L222,462.6953" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="16" y="479.7622">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="104.5586" x="24.2646" y="494.895">"jsonrpc": "2.0",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="44.7383" x="24.2646" y="510.0278">"id": 0,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="65.8062" x="24.2646" y="525.1606">"result": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="135.002" x="32.5293" y="540.2935">"protocolVersion": 1,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="142.124" x="32.5293" y="555.4263">"agentCapabilities": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.667" x="40.7939" y="570.5591">"loadSession": true,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="152.1343" x="40.7939" y="585.6919">"promptCapabilities": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.7744" x="49.0586" y="600.8247">"image": true,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.5522" x="49.0586" y="615.9575">"audio": false,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="167.9717" x="49.0586" y="631.0903">"embeddedContext": true</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="40.7939" y="646.2231">},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="132.6343" x="40.7939" y="661.356">"mcpCapabilities": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="82.2148" x="49.0586" y="676.4888">"http": false,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="72.9409" x="49.0586" y="691.6216">"sse": false</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="40.7939" y="706.7544">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="32.5293" y="721.8872">},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="90.8984" x="32.5293" y="737.02">"agentInfo": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162.1699" x="40.7939" y="752.1528">"name": "activecontext",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153.5752" x="40.7939" y="767.2856">"title": "ActiveContext",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="113.1216" x="40.7939" y="782.4185">"version": "0.1.0"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="32.5293" y="797.5513">},</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="115.686" x="32.5293" y="812.6841">"authMethods": []</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="24.2646" y="827.8169">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="16" y="842.9497">}</text><path d="M126,861.0156 L126,916.0156 L520,916.0156 L520,871.0156 L510,861.0156 L126,861.0156" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M510,861.0156 L510,871.0156 L520,871.0156 L510,861.0156" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="187.1797" x="132" y="878.0825">Protocol version negotiation:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="373.8896" x="132" y="893.2153">- If agent supports requested version, respond with same</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="330.2559" x="132" y="908.3481">- Otherwise, respond with latest supported version</text><?plantuml-src ZLHDZnCn3BtdLvYSsrMtY4iFIBCZ8HO9iLeG5yGXdRYTG2O9YMUBGFtlEDFfV6ofj8UH9dxsY-td-1NLs204gumJWWnPXA9yW8VeoLVUmXBkdI6ZhFcZo7W7xvNJgLO_KOYW8fdA1EK8P6aDEfAW4fHpfDWpa1ahJAbpA8GeOVaMIjX02khWG7K-gTs6avjG5PadHJZu5knhpgcWS9wnQFOrYRy2GFv8tiLGoGt8zSrABhBDQ3wkkjy6gVRvA4UEanEdgfh4IAR9vxxohnWJryl0xUA4L5s5fGfgQooJu1Z5w6vwudD4fR_WRtfdB392iSN5Y1wY8Nm6z-Znx2O9OsESibFyE4lctktyD0cdcimcez4OvKYKTSts3qXtaQLEy3ZtU1ggbUlL-itDQtcwJUJlAD1fo1qNee1bBzmm5_Y8ANYNUb4ixbwcISJKMdf9vxlfkDPuwvN-p2Dp2fdsEJCsuLfWJgPXvajnLAjDRkjEsJIrOxD5hL6NtX5BTqssfWhNhwo9md-eKyApzSmtaxlhm3MrkxU2LP_LfUf5XvVFyOdcgvjR5cX-Oqlrn-xLv0g-VR-OX4vipoHGBlYLmhWpUc9mkFSy8dbjR1ZdLR8R7de8FbA2YBzQJ8Jw7BHWKvuc3GT3DIGkiGlzn8ig7WmtRUvWUKUaWN3a6HBz1m00?></g></svg>